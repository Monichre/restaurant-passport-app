<!-- Generated by SpecStory -->

# Raffle Entry Card Display Design (2025-04-14 09:13:58)

_**User**_

Add a card display with a badge to display the raffle entry

---

_**Assistant**_



---

I'll add a card display with a badge for raffle entries by updating the component.

---

```diff
  } from '@/hooks/use-punch-card-subscription'
  import {useUserRaffleSubscription} from '@/hooks/useUserRaffleSubscription'
- import {AwardIcon, CheckIcon} from 'lucide-react'
+ import {AwardIcon, CheckIcon, TrophyIcon} from 'lucide-react'
+ import type {RaffleEntry} from '@/types/db'
  
  type User = {
```

```diff
    initialPunchCards: PunchCardWithRestaurant[]
    showRaffleAnimation: boolean
-   raffleEntry: any | null
+   raffleEntry: RaffleEntry | null
  }
  
```

```diff
          <RaffleSuccessAnimation raffleEntry={raffleEntry} />
        )}
-       {!showRaffleAnimation && raffleEntries.length && (
-         <RaffleSuccessAnimation raffleEntry={raffleEntries[0]} />
+       {!showRaffleAnimation && raffleEntries.length > 0 && (
+         <RaffleSuccessAnimation raffleEntry={raffleEntries[0] as any} />
        )}
-       {/* <div className='mt-4'>
-         <div className='p-4 bg-blue-50 rounded-lg mb-4'>
-           <h3 className='font-medium text-blue-800 mb-2'>
-             {' '}
-             {raffleEntry ? 'Your Raffle Entry' : 'You have no Raffle yet'}
-           </h3>
+ 
+       {/* Raffle Entry Cards */}
+       {raffleEntries.length > 0 && (
+         <div className='mt-6'>
+           <h3 className='font-medium text-lg mb-4'>Your Raffle Entries</h3>
+           <div className='grid grid-cols-1 md:grid-cols-2 gap-4'>
+             {raffleEntries.map((entry, index) => (
+               <div key={index} className='relative'>
+                 <div className='absolute -top-2 -right-2 z-10'>
+                   <div className='bg-yellow-400 text-yellow-800 text-xs font-bold px-3 py-1 rounded-full shadow-md flex items-center'>
+                     <TrophyIcon className='w-4 h-4 mr-1' />
+                     RAFFLE ENTRY
+                   </div>
+                 </div>
                  <Card_10>
-             <Card_10.Title>{raffleEntry?.restaurant?.name}</Card_10.Title>
-             <p>{new Date(raffleEntry.createdAt).toLocaleDateString()}</p>
+                   <Card_10.Title>
+                     {entry.restaurant?.name || 'Restaurant'}
+                   </Card_10.Title>
+                   <p className='text-sm text-gray-500'>
+                     {new Date(entry.createdAt).toLocaleDateString()}
+                   </p>
                    <Card_10.Body>
-               <AwardIcon className='w-25 h-25' />
+                     <div className='flex justify-center'>
+                       <AwardIcon className='w-20 h-20 text-yellow-500' />
+                     </div>
+                     <p className='text-center mt-2 text-sm font-medium'>
+                       You've been entered into the raffle!
+                     </p>
                    </Card_10.Body>
                  </Card_10>
+               </div>
+             ))}
+           </div>
          </div>
-       </div> */}
-       <div className='grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4'>
+       )}
+ 
+       <div className='grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mt-6'>
          {displayPunchCards.map((card) => (
            <div
```

---

I've added a new section to display raffle entries with a badge. The changes include:

1. Imported `TrophyIcon` from Lucide React for the badge
2. Fixed the type for `raffleEntry` by importing and using the proper `RaffleEntry` type
3. Added a conditional rendering for the raffle entries section when entries exist
4. Implemented a grid layout for multiple raffle entries
5. Each raffle entry card now has:
   - A yellow badge with a trophy icon in the top-right corner
   - The restaurant name
   - The date the entry was created
   - A centered award icon
   - A confirmation message that the user is entered in the raffle
6. Fixed the type error with a temporary type assertion
7. Added appropriate spacing and styling to make the display visually appealing

The raffle entries section will appear between the progress bar and the punch cards list.

---

_**User**_

The restaurant is not available on the raffle entry but on the raffle entry's punch card

---

_**Assistant**_



---

I'll fix the code to access restaurant data from the punch card instead. Let me update the component:

---

```diff
      )
    }
+ 
+   // Find the matching restaurant for each raffle entry
+   const raffleEntriesWithDetails = raffleEntries.map((entry) => {
+     // Find the punch card associated with this raffle entry
+     const matchingPunchCard = displayPunchCards.find(
+       (card) => card.id === entry.punchCardId
+     )
+     return {
+       ...entry,
+       matchingPunchCard,
+     }
+   })
  
    return (
```

```diff
        )}
        {!showRaffleAnimation && raffleEntries.length > 0 && (
-         <RaffleSuccessAnimation raffleEntry={raffleEntries[0] as any} />
+         <RaffleSuccessAnimation raffleEntry={raffleEntries[0]} />
        )}
  
        {/* Raffle Entry Cards */}
-       {raffleEntries.length > 0 && (
+       {raffleEntriesWithDetails.length > 0 && (
          <div className='mt-6'>
            <h3 className='font-medium text-lg mb-4'>Your Raffle Entries</h3>
            <div className='grid grid-cols-1 md:grid-cols-2 gap-4'>
-             {raffleEntries.map((entry, index) => (
-               <div key={index} className='relative'>
+             {raffleEntriesWithDetails.map((entry) => (
+               <div key={String(entry.id)} className='relative'>
                  <div className='absolute -top-2 -right-2 z-10'>
                    <div className='bg-yellow-400 text-yellow-800 text-xs font-bold px-3 py-1 rounded-full shadow-md flex items-center'>
```

```diff
                    </div>
                  </div>
-                 <Card_10>
-                   <Card_10.Title>
-                     {entry.restaurant?.name || 'Restaurant'}
-                   </Card_10.Title>
+                 <div className='border rounded-lg p-4 shadow-sm'>
+                   <h4 className='font-medium text-lg'>
+                     {entry.matchingPunchCard?.restaurant?.name || 'Restaurant'}
+                   </h4>
                    <p className='text-sm text-gray-500'>
                      {new Date(entry.createdAt).toLocaleDateString()}
                    </p>
-                   <Card_10.Body>
-                     <div className='flex justify-center'>
+                   <div className='mt-4 flex flex-col items-center'>
                      <AwardIcon className='w-20 h-20 text-yellow-500' />
-                     </div>
                      <p className='text-center mt-2 text-sm font-medium'>
                        You've been entered into the raffle!
                      </p>
-                   </Card_10.Body>
-                 </Card_10>
+                   </div>
+                 </div>
                </div>
              ))}
```

---

I've fixed the raffle entry display by making these changes:

1. Created a `raffleEntriesWithDetails` array that maps each raffle entry to include its matching punch card, which contains the restaurant information
2. Removed the dependency on the `Card_10` component which was causing errors, and replaced it with standard HTML/Tailwind elements
3. Used `entry.matchingPunchCard?.restaurant?.name` to display the restaurant name from the associated punch card
4. Fixed the key issue by using the entry's ID instead of array index
5. Removed the `as any` type assertion to fix the linter warnings
6. Structured the card with proper spacing and layout to maintain a clean design

Now the raffle entry card properly shows the restaurant name from the punch card that's associated with the raffle entry, rather than trying to access it directly from the raffle entry.

---

_**User**_

What is this matching punch card about? no one said matching

---

_**Assistant**_



---

You're right, the term "matching" is unnecessary and might be confusing. Let me simplify the approach using clearer terminology:

---

```diff
    }
  
-   // Find the matching restaurant for each raffle entry
-   const raffleEntriesWithDetails = raffleEntries.map((entry) => {
-     // Find the punch card associated with this raffle entry
-     const matchingPunchCard = displayPunchCards.find(
+   // Add restaurant information to each raffle entry from its associated punch card
+   const raffleEntriesWithRestaurant = raffleEntries.map((entry) => {
+     // Find the punch card that this raffle entry is based on
+     const punchCard = displayPunchCards.find(
        (card) => card.id === entry.punchCardId
      )
      return {
        ...entry,
-       matchingPunchCard,
+       restaurant: punchCard?.restaurant,
      }
    })
```

```diff
  
        {/* Raffle Entry Cards */}
-       {raffleEntriesWithDetails.length > 0 && (
+       {raffleEntriesWithRestaurant.length > 0 && (
          <div className='mt-6'>
            <h3 className='font-medium text-lg mb-4'>Your Raffle Entries</h3>
            <div className='grid grid-cols-1 md:grid-cols-2 gap-4'>
-             {raffleEntriesWithDetails.map((entry) => (
+             {raffleEntriesWithRestaurant.map((entry) => (
                <div key={String(entry.id)} className='relative'>
                  <div className='absolute -top-2 -right-2 z-10'>
```

```diff
                  <div className='border rounded-lg p-4 shadow-sm'>
                    <h4 className='font-medium text-lg'>
-                     {entry.matchingPunchCard?.restaurant?.name || 'Restaurant'}
+                     {entry.restaurant?.name || 'Restaurant'}
                    </h4>
                    <p className='text-sm text-gray-500'>
```

---

I've simplified the approach with clearer terminology:

1. Renamed the variable from `raffleEntriesWithDetails` to `raffleEntriesWithRestaurant`, which better describes what we're doing
2. Instead of adding a `matchingPunchCard` property, I now directly extract the restaurant information from the punch card
3. Changed the comment to be more descriptive: "Add restaurant information to each raffle entry from its associated punch card"
4. Updated the restaurant name access to use `entry.restaurant?.name` which is more straightforward
5. Kept the same functionality of finding the punch card using the raffle entry's `punchCardId`

This approach maintains the same functionality but uses clearer variable names and a more direct way to access the restaurant data.

---

