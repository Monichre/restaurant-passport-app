<!-- Generated by SpecStory -->

# Global Decorator for Storybook Stories (2025-03-26 11:53:42)

_**User**_

Create a decorator that globally wraps the storybook Story @story

---

_**Assistant**_

Let me create a global decorator for your Storybook stories.

---

<details>
            <summary>Searched codebase ".storybook" • **3** results</summary>
        
| File |
|------|
| `undefined` |
| `undefined` |
| `undefined` |

</details>

---

Let's first check the preview file, which is where global decorators are typically defined.

---

Read file: /Users/liamellis/Desktop/restaurant-passport-app/.storybook/preview.ts

---

Now let's also look at the main.ts file to understand the Storybook configuration.

---

Read file: /Users/liamellis/Desktop/restaurant-passport-app/.storybook/main.ts

---

Let's check if there are any existing decorators in the project to understand the pattern.

---

<details>
            <summary>Grep search for "decorator" • **1** files</summary>
        
| File | Line | Match |
|------|------|-------|
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/components/nav/nav.stories.tsx` | L156 | `// This is a decorator component that shows what tab was last clicked` |

</details>

---

Let's check the nav.stories.tsx file to see how decorators are used in this project.

---

Read file: /Users/liamellis/Desktop/restaurant-passport-app/src/components/nav/nav.stories.tsx

---

Let's see if there are more decorators in the project.

---

<details>
            <summary>Grep search for "decorators" • **0** files</summary>
        
No results found
</details>

---

Now let's check for Next.js Providers or context providers in the project that might be useful for our decorator.

---

<details>
            <summary>Grep search for "Provider" • **11** files</summary>
        
| File | Line | Match |
|------|------|-------|
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/components/icons/info-card.tsx` | L154 | `<InfoCardContext.Provider value={cardContextValue}>` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/components/icons/info-card.tsx` | L155 | `<InfoCardImageContext.Provider value={imageContextValue}>` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/components/icons/info-card.tsx` | L178 | `</InfoCardImageContext.Provider>` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/components/icons/info-card.tsx` | L179 | `</InfoCardContext.Provider>` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/components/icons/info-card.tsx` | L321 | `<InfoCardImageContext.Provider` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/components/icons/info-card.tsx` | L420 | `</InfoCardImageContext.Provider>` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/components/ui/form.tsx` | L7 | `FormProvider,` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/components/ui/form.tsx` | L18 | `const Form = FormProvider` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/components/ui/form.tsx` | L38 | `<FormFieldContext.Provider value={{ name: props.name }}>` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/components/ui/form.tsx` | L40 | `</FormFieldContext.Provider>` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/components/ui/form.tsx` | L79 | `<FormItemContext.Provider value={{ id }}>` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/components/ui/form.tsx` | L85 | `</FormItemContext.Provider>` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/components/admin/SidebarContext.tsx` | L16 | `export function SidebarProvider({ children }: { children: ReactNode }) {` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/components/admin/SidebarContext.tsx` | L24 | `<SidebarContext.Provider value={{ collapsed, toggleCollapse }}>` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/components/admin/SidebarContext.tsx` | L26 | `</SidebarContext.Provider>` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/components/admin/SidebarContext.tsx` | L33 | `throw new Error("useSidebar must be used within a SidebarProvider");` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/components/admin/admin-ui.tsx` | L2 | `import { SidebarProvider } from "@/components/admin/SidebarContext";` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/components/admin/admin-ui.tsx` | L8 | `<SidebarProvider>` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/components/admin/admin-ui.tsx` | L12 | `</SidebarProvider>` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/app/layout.tsx` | L2 | `import {ClerkProvider} from '@clerk/nextjs'` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/app/layout.tsx` | L4 | `import {LocationProvider} from '@/context/location-context'` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/app/layout.tsx` | L8 | `import {UserProvider} from '@/context/user-context'` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/app/layout.tsx` | L33 | `<ClerkProvider>` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/app/layout.tsx` | L34 | `<LocationProvider>` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/app/layout.tsx` | L35 | `<UserProvider>` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/app/layout.tsx` | L57 | `</UserProvider>` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/app/layout.tsx` | L58 | `</LocationProvider>` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/app/layout.tsx` | L59 | `</ClerkProvider>` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/app/admin/layout.tsx` | L20 | `// Render the admin UI with the SidebarProvider (which uses "use client")` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/components/ui/tooltip.tsx` | L7 | `const TooltipProvider = TooltipPrimitive.Provider` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/components/ui/tooltip.tsx` | L31 | `export { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/components/ui/sidebar.tsx` | L17 | `TooltipProvider,` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/components/ui/sidebar.tsx` | L43 | `throw new Error("useSidebar must be used within a SidebarProvider.");` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/components/ui/sidebar.tsx` | L49 | `const SidebarProvider = React.forwardRef<` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/components/ui/sidebar.tsx` | L140 | `<SidebarContext.Provider value={contextValue}>` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/components/ui/sidebar.tsx` | L141 | `<TooltipProvider delayDuration={0}>` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/components/ui/sidebar.tsx` | L159 | `</TooltipProvider>` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/components/ui/sidebar.tsx` | L160 | `</SidebarContext.Provider>` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/components/ui/sidebar.tsx` | L164 | `SidebarProvider.displayName = "SidebarProvider";` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/components/ui/sidebar.tsx` | L765 | `SidebarProvider,` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/components/ui/animated-modal.tsx` | L20 | `export const ModalProvider = ({children}: {children: ReactNode}) => {` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/components/ui/animated-modal.tsx` | L24 | `<ModalContext.Provider value={{open, setOpen}}>` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/components/ui/animated-modal.tsx` | L26 | `</ModalContext.Provider>` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/components/ui/animated-modal.tsx` | L33 | `throw new Error('useModal must be used within a ModalProvider')` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/components/ui/animated-modal.tsx` | L39 | `return <ModalProvider>{children}</ModalProvider>` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/context/user-context.tsx` | L33 | `export const UserProvider: React.FC<{children: React.ReactNode}> = ({` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/context/user-context.tsx` | L113 | `<UserContext.Provider value={{currentUser, isLoading, error, reloadUser}}>` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/context/user-context.tsx` | L115 | `</UserContext.Provider>` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/context/user-context.tsx` | L122 | `throw new Error('useUserContext must be used within a UserProvider')` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/context/location-context.tsx` | L14 | `export const LocationProvider = ({` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/context/location-context.tsx` | L23 | `<LocationContext.Provider value={value}>` |
| `file:///Users/liamellis/Desktop/restaurant-passport-app/src/context/location-context.tsx` | L25 | `</LocationContext.Provider>` |

</details>

---

Let's look at the app layout to see what providers are used at the root level that might be needed for our stories.

---

Read file: /Users/liamellis/Desktop/restaurant-passport-app/src/app/layout.tsx

---

Based on my analysis, I'll now create a global decorator for your Storybook stories that wraps all stories with the providers needed from your main layout, and adds a basic container with padding. I'll edit the preview.ts file to add this decorator.

---

```diff
  import type { Preview } from "@storybook/react";
  import "../src/app/globals.css";
+ import { LocationProvider } from "../src/context/location-context";
+ import { UserProvider } from "../src/context/user-context";
+ import type { Decorator } from "@storybook/react";
+ import React from "react";
+ import { Toaster } from "../src/components/ui/sonner";
+ 
+ // Global decorator to wrap all stories
+ const withGlobalWrapper: Decorator = (Story) => {
+ 	return (
+ 		<div
+ 			style={{
+ 				padding: "1rem",
+ 				minHeight: "100vh",
+ 				position: "relative",
+ 				backgroundColor: "#faf9f6",
+ 				backgroundImage: "radial-gradient(#e0e0e0 1px, transparent 1px)",
+ 				backgroundSize: "20px 20px",
+ 			}
+ };
+ >
+ 			<div style=
+ {
+ 	position: "relative", zIndex;
+ 	: 10
+ }
+ >
+ 				<LocationProvider>
+ 					<UserProvider>
+ 						<Story />
+ 						<Toaster />
+ 					</UserProvider>
+ 				</LocationProvider>
+ 			</div>
+ 		</div>
+ 	)
+ }
  
  const preview: Preview = {
```

```diff
  		},
  	},
+ 	decorators: [withGlobalWrapper],
  };
  
```

---

Let's fix the issues with the decorator in the preview.ts file:

---



---

It looks like there are some issues with the JSX syntax in the TypeScript file. Let's create a new file called preview.jsx that will properly handle the JSX syntax and maintain the existing functionality:

---

```diff
- 
+ import type {Preview} from '@storybook/react'
+ import '../src/app/globals.css'
+ import {LocationProvider} from '../src/context/location-context'
+ import {UserProvider} from '../src/context/user-context'
+ import {Toaster} from '../src/components/ui/sonner'
+ import React from 'react'
+ 
+ // Global decorator to wrap all stories
+ const withGlobalWrapper = (Story) => {
+   return (
+     <div
+       style={{
+         padding: '1rem',
+         minHeight: '100vh',
+         position: 'relative',
+         backgroundColor: '#faf9f6',
+         backgroundImage: 'radial-gradient(#e0e0e0 1px, transparent 1px)',
+         backgroundSize: '20px 20px',
+       }}
+     >
+       <div style={{position: 'relative', zIndex: 10}}>
+         <LocationProvider>
+           <UserProvider>
+             <Story />
+             <Toaster />
+           </UserProvider>
+         </LocationProvider>
+       </div>
+     </div>
+   )
+ }
+ 
+ const preview: Preview = {
+   parameters: {
+     controls: {
+       matchers: {
+         color: /(background|color)$/i,
+         date: /Date$/i,
+       },
+     },
+   },
+   decorators: [withGlobalWrapper],
+ }
+ 
+ export default preview
+ 
```

---

Now let's remove the old preview.ts file since we've created a new .tsx file that will properly handle the JSX syntax:

---

Cancelled

---

_**User**_

I don't need a user provider. 
---
import React from 'react';

import type { Preview } from '@storybook/react';

const preview: Preview = {
  decorators: [
    // 👇 Defining the decorator in the preview file applies it to all stories
    (Story, { parameters }) => {
      // 👇 Make it configurable by reading from parameters
      const { pageLayout } = parameters;
      switch (pageLayout) {
        case 'page':
          return (
            // Your page layout is probably a little more complex than this ;)
            <div className="page-layout">
              <Story />
            </div>
          );
        case 'page-mobile':
          return (
            <div className="page-mobile-layout">
              <Story />
            </div>
          );
        default:
          // In the default case, don't apply a layout
          return <Story />;
      }
    },
  ],
};

export default preview;

---

_**Assistant**_

I'll update the preview.tsx file to remove the UserProvider and implement the pageLayout approach from your example.

---

```diff
  import '../src/app/globals.css'
  import {LocationProvider} from '../src/context/location-context'
- import {UserProvider} from '../src/context/user-context'
  import {Toaster} from '../src/components/ui/sonner'
  import React from 'react'
- 
- // Global decorator to wrap all stories
- const withGlobalWrapper = (Story) => {
-   return (
-     <div
-       style={{
-         padding: '1rem',
-         minHeight: '100vh',
-         position: 'relative',
-         backgroundColor: '#faf9f6',
-         backgroundImage: 'radial-gradient(#e0e0e0 1px, transparent 1px)',
-         backgroundSize: '20px 20px',
-       }}
-     >
-       <div style={{position: 'relative', zIndex: 10}}>
-         <LocationProvider>
-           <UserProvider>
-             <Story />
-             <Toaster />
-           </UserProvider>
-         </LocationProvider>
-       </div>
-     </div>
-   )
- }
  
  const preview: Preview = {
```

```diff
      },
    },
-   decorators: [withGlobalWrapper],
+   decorators: [
+     // 👇 Defining the decorator in the preview file applies it to all stories
+     (Story, {parameters}) => {
+       // 👇 Make it configurable by reading from parameters
+       const {pageLayout} = parameters
+       switch (pageLayout) {
+         case 'page':
+           return (
+             <div
+               style={{
+                 padding: '1rem',
+                 minHeight: '100vh',
+                 position: 'relative',
+                 backgroundColor: '#faf9f6',
+                 backgroundImage:
+                   'radial-gradient(#e0e0e0 1px, transparent 1px)',
+                 backgroundSize: '20px 20px',
+               }}
+             >
+               <div style={{position: 'relative', zIndex: 10}}>
+                 <LocationProvider>
+                   <Story />
+                   <Toaster />
+                 </LocationProvider>
+               </div>
+             </div>
+           )
+         case 'page-mobile':
+           return (
+             <div
+               style={{
+                 padding: '0.5rem',
+                 maxWidth: '480px',
+                 margin: '0 auto',
+                 minHeight: '100vh',
+                 position: 'relative',
+                 backgroundColor: '#faf9f6',
+                 backgroundImage:
+                   'radial-gradient(#e0e0e0 1px, transparent 1px)',
+                 backgroundSize: '20px 20px',
+               }}
+             >
+               <div style={{position: 'relative', zIndex: 10}}>
+                 <LocationProvider>
+                   <Story />
+                   <Toaster />
+                 </LocationProvider>
+               </div>
+             </div>
+           )
+         default:
+           // In the default case, just wrap with LocationProvider without additional styling
+           return (
+             <LocationProvider>
+               <Story />
+             </LocationProvider>
+           )
+       }
+     },
+   ],
  }
  
```

---

Now let's try to fix the problems with the preview.ts file by deleting it:

---

Cancelled

---



---

